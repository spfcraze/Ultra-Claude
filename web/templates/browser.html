<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UltraClaude - Browser Automation</title>
    <link rel="icon" type="image/svg+xml" href="/static/favicon.svg">
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="/static/css/browser.css">
    <script src="/static/js/updater.js" defer></script>
</head>
<body>
    <div class="app">
        <header class="header">
            <div class="header-left">
                <div class="logo">
                    <a href="/" style="text-decoration: none; color: inherit; display: flex; align-items: center; gap: 8px;">
                        <span class="logo-icon">&#9889;</span>
                        <span class="logo-text">UltraClaude</span>
                    </a>
                </div>
                <nav class="nav-tabs">
                    <a href="/" class="nav-tab" data-page="sessions"><span class="nav-tab-icon">◉</span> <span class="nav-tab-label">Sessions</span></a>
                    <a href="/projects" class="nav-tab" data-page="projects"><span class="nav-tab-icon">◫</span> <span class="nav-tab-label">Projects</span></a>
                    <a href="/issues" class="nav-tab" data-page="issues"><span class="nav-tab-icon">◎</span> <span class="nav-tab-label">Issues</span></a>
                    <a href="/workflows" class="nav-tab" data-page="workflows"><span class="nav-tab-icon">⟡</span> <span class="nav-tab-label">Workflows</span></a>
                    <a href="/browser" class="nav-tab active" data-page="browser"><span class="nav-tab-icon">◳</span> <span class="nav-tab-label">Browser</span></a>
                    <a href="/settings" class="nav-tab" data-page="settings"><span class="nav-tab-icon">⚙</span> <span class="nav-tab-label">Settings</span></a>
                </nav>
            </div>
            <div class="header-right">
                <div class="header-stats">
                    <span id="browser-stats">No sessions</span>
                </div>
                <button class="btn btn-primary" onclick="browserApp.openNewSessionModal()">
                    + New Session
                </button>
            </div>
        </header>

        <div class="main browser-main">
            <!-- Session Sidebar -->
            <div class="browser-sidebar">
                <div class="panel-header">
                    <h2>Sessions</h2>
                    <button class="btn btn-small" onclick="browserApp.refreshSessions()" title="Refresh">&#x21bb;</button>
                </div>
                <div class="session-list" id="session-list">
                    <div class="no-sessions">
                        <div class="no-sessions-icon">&#127760;</div>
                        <p>No browser sessions</p>
                    </div>
                </div>
            </div>

            <!-- Main Content -->
            <div class="browser-content">
                <!-- URL Bar -->
                <div class="url-bar">
                    <button class="btn btn-small" onclick="browserApp.takeScreenshot()" title="Screenshot" id="btn-screenshot" disabled>&#128247;</button>
                    <input type="text" class="url-input" id="url-input" placeholder="Enter URL and press Enter..."
                           onkeypress="if(event.key==='Enter')browserApp.navigate()" disabled>
                    <button class="btn btn-small btn-primary" onclick="browserApp.navigate()" id="btn-go" disabled>Go</button>
                    <button class="btn btn-small" onclick="browserApp.openInteractModal()" id="btn-interact" disabled title="Interact">&#9881;</button>
                </div>

                <!-- Viewport -->
                <div class="viewport-area" id="viewport-area">
                    <div class="viewport-placeholder" id="viewport-placeholder">
                        <div class="viewport-placeholder-icon">&#127760;</div>
                        <p>No browser session selected</p>
                        <p class="hint">Create a new session to get started</p>
                    </div>
                </div>

                <!-- Bottom Panels -->
                <div class="browser-panels">
                    <div class="panel-tabs">
                        <button class="panel-tab active" data-panel="console" onclick="browserApp.switchPanel('console')">
                            Console <span class="panel-tab-badge" id="console-count">0</span>
                        </button>
                        <button class="panel-tab" data-panel="network" onclick="browserApp.switchPanel('network')">
                            Network <span class="panel-tab-badge" id="network-count">0</span>
                        </button>
                        <button class="panel-tab" data-panel="screenshots" onclick="browserApp.switchPanel('screenshots')">
                            Screenshots <span class="panel-tab-badge" id="screenshots-count">0</span>
                        </button>
                        <button class="panel-tab" data-panel="actions" onclick="browserApp.switchPanel('actions')">
                            Actions <span class="panel-tab-badge" id="actions-count">0</span>
                        </button>
                    </div>
                    <div class="panel-body">
                        <div class="panel-content active" id="panel-console">
                            <div class="panel-empty" id="console-empty">
                                <div class="panel-empty-icon">&#128196;</div>
                                <p>No console logs yet</p>
                            </div>
                        </div>
                        <div class="panel-content" id="panel-network">
                            <div class="panel-empty" id="network-empty">
                                <div class="panel-empty-icon">&#127760;</div>
                                <p>No network activity yet</p>
                            </div>
                        </div>
                        <div class="panel-content" id="panel-screenshots">
                            <div class="panel-empty" id="screenshots-empty">
                                <div class="panel-empty-icon">&#128247;</div>
                                <p>No screenshots taken yet</p>
                            </div>
                        </div>
                        <div class="panel-content" id="panel-actions">
                            <div class="panel-empty" id="actions-empty">
                                <div class="panel-empty-icon">&#9889;</div>
                                <p>No actions performed yet</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- New Session Modal -->
    <div class="modal" id="new-session-modal">
        <div class="modal-content">
            <h3>New Browser Session</h3>
            <div class="browser-modal-form">
                <div class="form-group">
                    <label for="session-name">Session Name</label>
                    <input type="text" id="session-name" placeholder="My Browser Session">
                </div>
                <div class="form-group">
                    <label for="browser-type">Browser</label>
                    <select id="browser-type">
                        <option value="chromium">Chromium</option>
                        <option value="firefox">Firefox</option>
                        <option value="webkit">WebKit</option>
                    </select>
                </div>
                <div class="form-row-2">
                    <div class="form-group">
                        <label for="viewport-width">Width</label>
                        <input type="number" id="viewport-width" value="1280" min="320" max="3840">
                    </div>
                    <div class="form-group">
                        <label for="viewport-height">Height</label>
                        <input type="number" id="viewport-height" value="720" min="240" max="2160">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-checkbox">
                        <input type="checkbox" id="session-headless" checked>
                        Headless Mode
                    </label>
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn" onclick="browserApp.closeNewSessionModal()">Cancel</button>
                <button class="btn btn-primary" onclick="browserApp.createSession()">Create</button>
            </div>
        </div>
    </div>

    <!-- Interact Modal -->
    <div class="modal" id="interact-modal">
        <div class="modal-content modal-large">
            <h3>Interact with Page</h3>
            <div class="interact-tabs">
                <button class="interact-tab active" onclick="browserApp.switchInteractTab('click')">Click</button>
                <button class="interact-tab" onclick="browserApp.switchInteractTab('type')">Type</button>
                <button class="interact-tab" onclick="browserApp.switchInteractTab('evaluate')">Evaluate JS</button>
                <button class="interact-tab" onclick="browserApp.switchInteractTab('wait')">Wait</button>
                <button class="interact-tab" onclick="browserApp.switchInteractTab('extract')">Extract</button>
            </div>
            <div class="interact-panel active" id="interact-click">
                <div class="form-group">
                    <label>CSS Selector</label>
                    <input type="text" id="click-selector" placeholder="e.g., button.submit, #login-btn, a[href='/']">
                </div>
                <button class="btn btn-primary" onclick="browserApp.doClick()">Click Element</button>
            </div>
            <div class="interact-panel" id="interact-type">
                <div class="form-group">
                    <label>CSS Selector</label>
                    <input type="text" id="type-selector" placeholder="e.g., input[name='email'], #search-box">
                </div>
                <div class="form-group">
                    <label>Text</label>
                    <input type="text" id="type-text" placeholder="Text to type...">
                </div>
                <button class="btn btn-primary" onclick="browserApp.doType()">Type Text</button>
            </div>
            <div class="interact-panel" id="interact-evaluate">
                <div class="form-group">
                    <label>JavaScript Expression</label>
                    <textarea id="eval-expression" rows="4" style="width:100%; padding:8px; border:1px solid var(--border-color); border-radius:6px; background:var(--bg-tertiary); color:var(--text-primary); font-family:monospace; font-size:13px;" placeholder="e.g., document.title"></textarea>
                </div>
                <button class="btn btn-primary" onclick="browserApp.doEvaluate()">Evaluate</button>
                <div id="eval-result" style="margin-top:12px; display:none;">
                    <label style="font-size:12px; color:var(--text-secondary); display:block; margin-bottom:4px;">Result:</label>
                    <pre id="eval-result-content" style="padding:10px; background:var(--bg-primary); border-radius:6px; font-size:12px; max-height:150px; overflow:auto; white-space:pre-wrap;"></pre>
                </div>
            </div>
            <div class="interact-panel" id="interact-wait">
                <div class="form-group">
                    <label>CSS Selector</label>
                    <input type="text" id="wait-selector" placeholder="e.g., .loaded, #content">
                </div>
                <div class="form-group">
                    <label>State</label>
                    <select id="wait-state">
                        <option value="visible">Visible</option>
                        <option value="hidden">Hidden</option>
                        <option value="attached">Attached</option>
                        <option value="detached">Detached</option>
                    </select>
                </div>
                <button class="btn btn-primary" onclick="browserApp.doWait()">Wait</button>
            </div>
            <div class="interact-panel" id="interact-extract">
                <div class="form-group">
                    <label>CSS Selector (optional, empty = whole page)</label>
                    <input type="text" id="extract-selector" placeholder="e.g., .main-content, #article">
                </div>
                <div class="form-row-2">
                    <button class="btn btn-primary" onclick="browserApp.doExtract('text')">Extract Text</button>
                    <button class="btn" onclick="browserApp.doExtract('html')">Extract HTML</button>
                </div>
                <div id="extract-result" style="margin-top:12px; display:none;">
                    <label style="font-size:12px; color:var(--text-secondary); display:block; margin-bottom:4px;">Result:</label>
                    <pre id="extract-result-content" style="padding:10px; background:var(--bg-primary); border-radius:6px; font-size:12px; max-height:200px; overflow:auto; white-space:pre-wrap;"></pre>
                </div>
            </div>
            <div class="modal-actions" style="margin-top:16px;">
                <button class="btn" onclick="browserApp.closeInteractModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- Screenshot Preview Modal -->
    <div class="modal" id="screenshot-modal">
        <div class="modal-content" style="width: 90vw; max-width: 1200px;">
            <div class="modal-header" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
                <h3 id="screenshot-modal-title">Screenshot</h3>
                <button class="btn btn-small" onclick="browserApp.closeScreenshotModal()">x</button>
            </div>
            <div style="text-align:center;">
                <img id="screenshot-modal-img" style="max-width:100%; max-height:70vh; border:1px solid var(--border-color); border-radius:4px;">
            </div>
        </div>
    </div>

    <script src="/static/js/browser.js"></script>
</body>
</html>
